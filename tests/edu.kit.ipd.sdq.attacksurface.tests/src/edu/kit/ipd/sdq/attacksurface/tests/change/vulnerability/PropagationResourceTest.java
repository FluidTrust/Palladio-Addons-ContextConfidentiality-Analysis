package edu.kit.ipd.sdq.attacksurface.tests.change.vulnerability;

import static org.junit.Assert.assertTrue;
import static org.junit.jupiter.api.Assertions.assertEquals;

import org.eclipse.emf.ecore.util.EcoreUtil;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.palladiosimulator.pcm.confidentiality.attackerSpecification.attackSpecification.AttackVector;
import org.palladiosimulator.pcm.confidentiality.attackerSpecification.attackSpecification.ConfidentialityImpact;
import org.palladiosimulator.pcm.confidentiality.attackerSpecification.attackSpecification.Privileges;
import org.palladiosimulator.pcm.confidentiality.attackerSpecification.pcmIntegration.PcmIntegrationFactory;
import org.palladiosimulator.pcm.confidentiality.context.system.pcm.structure.StructureFactory;
import org.palladiosimulator.pcm.repository.BasicComponent;
import org.palladiosimulator.pcm.seff.ResourceDemandingSEFF;

import edu.kit.ipd.sdq.attacksurface.tests.change.AbstractChangeTests;
//TODO
import edu.kit.ipd.sdq.kamp4attack.core.changepropagation.changes.ResourceContainerPropagationVulnerability;
import edu.kit.ipd.sdq.kamp4attack.model.modificationmarks.KAMP4attackModificationmarks.CredentialChange;
import edu.kit.ipd.sdq.kamp4attack.model.modificationmarks.KAMP4attackModificationmarks.KAMP4attackModificationmarksFactory;

public class PropagationResourceTest extends AbstractChangeTests {
    private void runResourceLocalAssemblyPropagation(final CredentialChange change) {
        final var wrapper = getBlackboardWrapper();
        final var assemblyChange = new ResourceContainerPropagationVulnerability(wrapper, change);
        assemblyChange.calculateResourceContainerToLocalAssemblyContextPropagation();
    }

    private void runResourceRemoteAssemblyPropagation(final CredentialChange change) {
        final var wrapper = getBlackboardWrapper();
        final var assemblyChange = new ResourceContainerPropagationVulnerability(wrapper, change);
        assemblyChange.calculateResourceContainerToRemoteAssemblyContextPropagation();
    }

    private void runResourceLinkingPropagation(final CredentialChange change) {
        final var wrapper = getBlackboardWrapper();
        final var assemblyChange = new ResourceContainerPropagationVulnerability(wrapper, change);
        assemblyChange.calculateResourceContainerToLinkingResourcePropagation();
    }

    private void runResourceResourcePropagation(final CredentialChange change) {
        final var wrapper = getBlackboardWrapper();
        final var assemblyChange = new ResourceContainerPropagationVulnerability(wrapper, change);
        assemblyChange.calculateResourceContainerToResourcePropagation();
    }

    @BeforeEach
    void initXML() {
        generateXML();
    }

    //TODO tests

}
